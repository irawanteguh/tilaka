<?php
 function curl($config) { $ci =& get_instance(); $ci->load->model("\115\x6f\x64\145\x6c\163\145\x72\166\151\x63\145\141\160\x69", "\155\x6c\x6f\147"); $curl = curl_init(); curl_setopt_array($curl, array(CURLOPT_URL => $config["\x75\162\x6c"], CURLOPT_CUSTOMREQUEST => $config["\155\x65\164\150\x6f\144"], CURLOPT_POSTFIELDS => $config["\142\x6f\144\x79"], CURLOPT_HTTPHEADER => $config["\150\x65\x61\x64\x65\162"], CURLOPT_RETURNTRANSFER => true, CURLOPT_ENCODING => '', CURLOPT_MAXREDIRS => 10, CURLOPT_TIMEOUT => 0, CURLOPT_FOLLOWLOCATION => true, CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1, CURLOPT_SSL_VERIFYHOST => 0, CURLOPT_SSL_VERIFYPEER => 0)); $response = curl_exec($curl); $source = explode("\x2d", $config["\x73\157\x75\x72\143\x65"]); $source = $source[0]; if ($source === "\105\113\114\101\x49\x4d") { $first = strpos($response, "\12") + 1; $last = strrpos($response, "\12") - 1; $response = substr($response, $first, strlen($response) - $first - $last); $response = Inacbg::inacbg_decrypt($response, KEY_EKLAIM); } $response_header = json_encode(curl_getinfo($curl)); $request_headers = json_encode(function_exists("\x61\x70\141\143\150\x65\x5f\162\x65\x71\165\x65\163\164\x5f\x68\x65\141\x64\x65\162\x73") ? apache_request_headers() : array()); $request_url = curl_getinfo($curl, CURLINFO_EFFECTIVE_URL); $response_status = curl_getinfo($curl, CURLINFO_HTTP_CODE); $appconnect_time_us = json_encode(curl_getinfo($curl)["\141\x70\160\x63\157\156\x6e\x65\143\x74\x5f\164\x69\x6d\145\x5f\165\x73"]); $connect_time_us = json_encode(curl_getinfo($curl)["\x63\x6f\156\x6e\x65\x63\x74\x5f\x74\151\x6d\x65\x5f\165\163"]); $namelookup_time_us = json_encode(curl_getinfo($curl)["\156\x61\x6d\x65\x6c\x6f\x6f\x6b\165\x70\x5f\164\x69\155\145\137\x75\x73"]); $pretransfer_time_us = json_encode(curl_getinfo($curl)["\160\x72\x65\x74\x72\141\x6e\163\146\x65\x72\137\164\x69\155\145\x5f\165\163"]); $redirect_time_us = json_encode(curl_getinfo($curl)["\162\x65\x64\x69\x72\x65\x63\164\137\164\x69\155\x65\x5f\x75\x73"]); $starttransfer_time_us = json_encode(curl_getinfo($curl)["\163\164\141\x72\164\164\162\141\x6e\x73\146\145\x72\x5f\x74\x69\x6d\145\137\x75\x73"]); $total_time_us = json_encode(curl_getinfo($curl)["\x74\157\164\x61\154\x5f\x74\x69\x6d\145\x5f\x75\163"]); curl_close($curl); if ($config["\163\141\166\145\154\157\147"]) { $requestlog = array("\117\x52\107\137\x49\104" => ORG_ID, "\122\105\121\x55\105\x53\x54\x5f\x49\x44" => round(microtime(true) * 1000), "\x52\x45\121\125\x45\123\x54\137\115\105\124\110\117\104" => $config["\x6d\x65\x74\x68\x6f\144"], "\122\105\121\125\105\x53\124\137\125\122\x4c" => $request_url, "\x52\105\121\x55\x45\123\124\x5f\x48\105\101\104\x45\122\x53" => $request_headers, "\122\x45\x51\125\105\123\x54\137\102\117\x44\x59" => $config["\x62\x6f\144\171"], "\125\123\105\x52\137\101\107\105\116\x54" => $_SERVER["\x48\124\124\120\x5f\x55\x53\x45\122\137\x41\107\105\x4e\x54"], "\122\x45\115\x4f\x54\105\x5f\101\104\x44\122\x45\123\x53" => $_SERVER["\x52\x45\115\x4f\x54\x45\137\x41\104\x44\x52"], "\122\x45\x53\120\x4f\116\x53\105\x5f\123\x54\x41\x54\125\123" => $response_status, "\122\x45\123\120\x4f\x4e\123\105\137\x48\x45\101\x44\105\x52\x53" => $response_header, "\122\x45\123\120\x4f\x4e\123\105\x5f\x42\117\104\x59" => $response, "\101\x50\120\x43\117\x4e\116\105\103\124\137\124\111\115\x45\137\x55\x53" => $appconnect_time_us, "\x43\x4f\116\116\105\x43\124\137\x54\111\115\x45\x5f\125\123" => $connect_time_us, "\x4e\101\115\x45\x4c\117\117\x4b\125\x50\x5f\x54\111\x4d\x45\x5f\125\x53" => $namelookup_time_us, "\x50\122\105\124\122\x41\116\123\x46\x45\x52\x5f\x54\111\x4d\x45\137\x55\x53" => $pretransfer_time_us, "\x52\105\x44\111\122\105\103\x54\x5f\x54\x49\x4d\105\x5f\125\123" => $redirect_time_us, "\123\x54\x41\x52\x54\x54\122\101\x4e\123\106\x45\x52\137\x54\111\115\x45\137\125\123" => $starttransfer_time_us, "\124\117\x54\101\x4c\137\x54\x49\115\x45\137\x55\123" => $total_time_us, "\x53\x4f\125\122\103\x45" => $config["\163\x6f\165\x72\x63\x65"]); $ci->mlog->savelog($requestlog); } return $response; } ?>